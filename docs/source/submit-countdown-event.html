<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">var plugin = Echo.Plugin.manifest(&quot;SubmitCountdownEvent&quot;, &quot;Echo.StreamServer.Controls.Submit&quot;);

plugin.init = function() {
	this.extendTemplate(&quot;insertAfter&quot;, &quot;content&quot;, plugin.countdownTemplate);
};

plugin.labels = {
	&quot;chatClosesIn&quot;: &quot;Chat closes in &quot;
};

plugin.renderers.countdownLabel = function(element) {
	var self = this;
	var submit = this.component;
	if (submit.config.get(&quot;mode&quot;) === &quot;compact&quot;) {
		return element.hide();
	}
	var time = this.config.get(&quot;eventEnd&quot;)
		? new Date(parseInt(this.config.get(&quot;eventEnd&quot;)))
		: new Date;
	return element.countdown(time, {
		&quot;prefix&quot;: this.labels.get(&quot;chatClosesIn&quot;),
		&quot;display&quot;: &quot;compact&quot;,
		&quot;finish&quot;: function() {
			self.events.publish({&quot;topic&quot;: &quot;onEventEnd&quot;});
		}
	});
};

plugin.component.renderers.tagsContainer =
plugin.component.renderers.markersContainer =
plugin.component.renderers.metadata = function(element) {
	return element.hide();
};

plugin.countdownTemplate = '&lt;div class=&quot;{plugin.class:countdownLabel} echo-secondaryFont echo-secondaryColor&quot;&gt;&lt;/div&gt;';

plugin.css =
	'.{plugin.class:countdownLabel} { float: left; margin-top: 15px; }';

Echo.Plugin.create(plugin);
</pre>
</body>
</html>
